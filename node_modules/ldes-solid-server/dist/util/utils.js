"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.reconstructIndex = exports.parseIndex = exports.cacheToLiteral = void 0;
function cacheToLiteral(instruction) {
    const pub = instruction.pub ? ["public"] : ["private"];
    const maxAge = instruction.maxAge ? ["max-age=" + instruction.maxAge] : [];
    const immutable = instruction.immutable ? ["immutable"] : [];
    return [...pub, ...maxAge, ...immutable].join(", ");
}
exports.cacheToLiteral = cacheToLiteral;
function parseIndex(index) {
    const [first, second] = index.split('?', 2);
    const query = {};
    if (second) {
        second.split("&").forEach(q => {
            const [key, value] = q.split("=", 2);
            query[key] = decodeURIComponent(value);
        });
    }
    if (first.length == 0) {
        return { segs: [], query };
    }
    return { segs: first.split("/"), query };
}
exports.parseIndex = parseIndex;
function reconstructIndex({ segs, query }) {
    const path = segs.join("/");
    const queries = [];
    for (let [key, value] of Object.entries(query)) {
        queries.push(`${key}=${value}`);
    }
    if (queries.length > 0) {
        return encodeURI(`${path}?${queries.join("&")}`);
    }
    else {
        return path;
    }
}
exports.reconstructIndex = reconstructIndex;
//# sourceMappingURL=utils.js.map