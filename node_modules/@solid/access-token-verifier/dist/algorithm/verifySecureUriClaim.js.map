{"version":3,"file":"verifySecureUriClaim.js","sourceRoot":"","sources":["../../src/algorithm/verifySecureUriClaim.ts"],"names":[],"mappings":";;;AAAA,8FAA2F;AAE3F;;;;;;;GAOG;AACH,SAAgB,oBAAoB,CAAC,GAAW,EAAE,KAAa;IAC7D,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,mBAAmB,CAAC,EAAE;QACvE,MAAM,IAAI,iEAA+B,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;KACvD;AACH,CAAC;AAJD,oDAIC","sourcesContent":["import { SecureUriClaimVerificationError } from \"../error/SecureUriClaimVerificationError\";\n\n/**\n * Verifies a URI claim is secured over TLS\n *\n * Currently restricts to HTTPS URIs and localhost.\n * TODO: Check if we can restrict to HTTP over TLS if/when in the future it is allowed or allow other protocols\n *\n * See also: https://solid.github.io/solid-oidc/#security-tls & https://github.com/solid/authentication-panel/issues/114#issuecomment-751867437\n */\nexport function verifySecureUriClaim(uri: string, claim: string): void {\n  if (!uri.startsWith(\"https://\") && !uri.startsWith(\"http://localhost:\")) {\n    throw new SecureUriClaimVerificationError(uri, claim);\n  }\n}\n"]}