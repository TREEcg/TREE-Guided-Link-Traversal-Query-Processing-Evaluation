{"version":3,"file":"verifyDpopProofJwkThumbprint.js","sourceRoot":"","sources":["../../src/algorithm/verifyDpopProofJwkThumbprint.ts"],"names":[],"mappings":";;;AAAA,+BAA8C;AAC9C,4FAAyF;AAGzF;;;;;;;;GAQG;AACI,KAAK,UAAU,4BAA4B,CAChD,GAAkB,EAClB,GAAW;IAEX,oDAAoD;IACpD,sGAAsG;IACtG,MAAM,MAAM,GAAG,MAAM,IAAA,6BAAsB,EAAC,GAAG,CAAC,CAAC;IACjD,IAAI,MAAM,KAAK,GAAG,EAAE;QAClB,MAAM,IAAI,+DAA8B,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;KACvD;AACH,CAAC;AAVD,oEAUC","sourcesContent":["import { calculateJwkThumbprint } from \"jose\";\nimport { JwkThumbprintVerificationError } from \"../error/JwkThumbprintVerificationError\";\nimport type { DPoPPublicJWK } from \"../type\";\n\n/**\n * Verifies the access token is bound to the DPoP public key\n *\n * > \"jkt\": JWK SHA-256 Thumbprint Confirmation Method.  The value of the \"jkt\" member MUST be the base64url encoding (as defined in [RFC7515]) of the JWK SHA-256 Thumbprint (according to [RFC7638]) of the DPoP public key (in JWK format) to which the access token is bound.\n * > -- https://datatracker.ietf.org/doc/html/draft-ietf-oauth-dpop-03#section-6.1\n *\n * @param jwk The DPoP proof header jwk parameter\n * @param jkt The access token cnf jkt parameter\n */\nexport async function verifyDpopProofJwkThumbprint(\n  jwk: DPoPPublicJWK,\n  jkt: string\n): Promise<void> {\n  // TODO find out what the unsafe assignment is about\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-call\n  const actual = await calculateJwkThumbprint(jwk);\n  if (actual !== jkt) {\n    throw new JwkThumbprintVerificationError(actual, jkt);\n  }\n}\n"]}