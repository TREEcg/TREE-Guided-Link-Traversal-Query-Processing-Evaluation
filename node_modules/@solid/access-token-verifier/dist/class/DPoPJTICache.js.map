{"version":3,"file":"DPoPJTICache.js","sourceRoot":"","sources":["../../src/class/DPoPJTICache.ts"],"names":[],"mappings":";;;;;;AAAA,0DAAiC;AACjC,sCAAuE;AAGvE,MAAa,YAAa,SAAQ,mBAAyB;IACzD;QACE,KAAK,CAAC;YACJ,GAAG,EAAE,CAAC,6BAAoB,GAAG,6BAAoB,CAAC,GAAG,IAAI;YACzD,MAAM,EAAE,6BAAoB;SAC7B,CAAC,CAAC;IACL,CAAC;IAEM,cAAc,CAAC,GAAW;QAC/B,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;YAC/B,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YACpB,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC;IACd,CAAC;CACF;AAfD,oCAeC","sourcesContent":["import LRUCache from \"lru-cache\";\nimport { maxAgeInMilliseconds, maxRequestsPerSecond } from \"../config\";\nimport type { JTICheckFunction } from \"../type\";\n\nexport class DPoPJTICache extends LRUCache<string, boolean> {\n  public constructor() {\n    super({\n      max: (maxRequestsPerSecond * maxAgeInMilliseconds) / 1000,\n      maxAge: maxAgeInMilliseconds,\n    });\n  }\n\n  public isDuplicateJTI(jti: string): ReturnType<JTICheckFunction> {\n    if (this.get(jti) === undefined) {\n      this.set(jti, true);\n      return false;\n    }\n    return true;\n  }\n}\n"]}