{"version":3,"file":"WebSocketAdvertiser.js","sourceRoot":"","sources":["../../../src/server/middleware/WebSocketAdvertiser.ts"],"names":[],"mappings":";;;AAAA,sDAA6D;AAC7D,gDAA6C;AAG7C;;GAEG;AACH,MAAa,mBAAoB,SAAQ,yBAAW;IAGlD,YAAmB,OAAe;QAChC,KAAK,EAAE,CAAC;QACR,MAAM,SAAS,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,CAAC;QACnC,SAAS,CAAC,QAAQ,GAAG,IAAA,sBAAS,EAAC,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC;QACvE,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC;IAClC,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,EAAE,QAAQ,EAA8B;QAC1D,IAAA,sBAAS,EAAC,QAAQ,EAAE,aAAa,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IACrD,CAAC;CACF;AAbD,kDAaC","sourcesContent":["import { addHeader, hasScheme } from '../../util/HeaderUtil';\nimport { HttpHandler } from '../HttpHandler';\nimport type { HttpResponse } from '../HttpResponse';\n\n/**\n * Handler that advertises a WebSocket through the Updates-Via header.\n */\nexport class WebSocketAdvertiser extends HttpHandler {\n  private readonly socketUrl: string;\n\n  public constructor(baseUrl: string) {\n    super();\n    const socketUrl = new URL(baseUrl);\n    socketUrl.protocol = hasScheme(baseUrl, 'http', 'ws') ? 'ws:' : 'wss:';\n    this.socketUrl = socketUrl.href;\n  }\n\n  public async handle({ response }: { response: HttpResponse }): Promise<void> {\n    addHeader(response, 'Updates-Via', this.socketUrl);\n  }\n}\n"]}