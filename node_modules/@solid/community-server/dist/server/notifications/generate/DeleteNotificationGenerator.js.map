{"version":3,"file":"DeleteNotificationGenerator.js","sourceRoot":"","sources":["../../../../src/server/notifications/generate/DeleteNotificationGenerator.ts"],"names":[],"mappings":";;;AAAA,0FAAuF;AACvF,6DAAgD;AAEhD,kDAAgF;AAEhF,mEAAgE;AAEhE;;;;GAIG;AACH,MAAa,2BAA4B,SAAQ,6CAAqB;IAC7D,KAAK,CAAC,SAAS,CAAC,EAAE,QAAQ,EAA4B;QAC3D,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,iBAAE,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE;YACtC,MAAM,IAAI,iDAAuB,CAAC,6CAA6C,CAAC,CAAC;SAClF;IACH,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,EAAE,KAAK,EAA4B;QACrD,OAAO;YACL,UAAU,EAAE;gBACV,sCAAuB;gBACvB,mCAAoB;aACrB;YACD,EAAE,EAAE,OAAO,IAAI,CAAC,GAAG,EAAE,IAAI,KAAK,CAAC,IAAI,EAAE;YACrC,IAAI,EAAE,CAAE,QAAQ,CAAE;YAClB,MAAM,EAAE;gBACN,EAAE,EAAE,KAAK,CAAC,IAAI;gBACd,IAAI,EAAE,EAAE;aACT;YACD,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;SACpC,CAAC;IACJ,CAAC;CACF;AAtBD,kEAsBC","sourcesContent":["import { NotImplementedHttpError } from '../../../util/errors/NotImplementedHttpError';\nimport { AS } from '../../../util/Vocabularies';\nimport type { Notification } from '../Notification';\nimport { CONTEXT_ACTIVITYSTREAMS, CONTEXT_NOTIFICATION } from '../Notification';\nimport type { NotificationHandlerInput } from '../NotificationHandler';\nimport { NotificationGenerator } from './NotificationGenerator';\n\n/**\n * Generates a {@link Notification} for a resource that was deleted.\n * This differs from other activity notifications in that there is no state and no resource metadata\n * since the resource no longer exists.\n */\nexport class DeleteNotificationGenerator extends NotificationGenerator {\n  public async canHandle({ activity }: NotificationHandlerInput): Promise<void> {\n    if (!activity?.equals(AS.terms.Delete)) {\n      throw new NotImplementedHttpError(`Only Delete activity updates are supported.`);\n    }\n  }\n\n  public async handle({ topic }: NotificationHandlerInput): Promise<Notification> {\n    return {\n      '@context': [\n        CONTEXT_ACTIVITYSTREAMS,\n        CONTEXT_NOTIFICATION,\n      ],\n      id: `urn:${Date.now()}:${topic.path}`,\n      type: [ 'Delete' ],\n      object: {\n        id: topic.path,\n        type: [],\n      },\n      published: new Date().toISOString(),\n    };\n  }\n}\n"]}