{"version":3,"file":"InteractionHandler.js","sourceRoot":"","sources":["../../../src/identity/interaction/InteractionHandler.ts"],"names":[],"mappings":";;;AAGA,0DAA2D;AAC3D,uFAAoF;AACpF,mEAAgE;AAiBhE;;;GAGG;AACH,MAAsB,kBAAmB,SAAQ,2BAAqD;IAC7F,KAAK,CAAC,SAAS,CAAC,EAAE,SAAS,EAA2B;QAC3D,MAAM,EAAE,WAAW,EAAE,GAAG,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC;QAChD,IAAI,WAAW,IAAI,WAAW,KAAK,+BAAgB,EAAE;YACnD,MAAM,IAAI,iDAAuB,CAAC,0CAA0C,CAAC,CAAC;SAC/E;IACH,CAAC;CACF;AAPD,gDAOC","sourcesContent":["import type { KoaContextWithOIDC } from 'oidc-provider';\nimport type { Operation } from '../../http/Operation';\nimport type { Representation } from '../../http/representation/Representation';\nimport { APPLICATION_JSON } from '../../util/ContentTypes';\nimport { NotImplementedHttpError } from '../../util/errors/NotImplementedHttpError';\nimport { AsyncHandler } from '../../util/handlers/AsyncHandler';\n\n// OIDC library does not directly export the Interaction type\nexport type Interaction = NonNullable<KoaContextWithOIDC['oidc']['entities']['Interaction']>;\n\nexport interface InteractionHandlerInput {\n  /**\n   * The operation to execute.\n   */\n  operation: Operation;\n  /**\n   * Will be defined if the OIDC library expects us to resolve an interaction it can't handle itself,\n   * such as logging a user in.\n   */\n  oidcInteraction?: Interaction;\n}\n\n/**\n * Handler used for IDP interactions.\n * Only supports JSON data.\n */\nexport abstract class InteractionHandler extends AsyncHandler<InteractionHandlerInput, Representation> {\n  public async canHandle({ operation }: InteractionHandlerInput): Promise<void> {\n    const { contentType } = operation.body.metadata;\n    if (contentType && contentType !== APPLICATION_JSON) {\n      throw new NotImplementedHttpError('Only application/json data is supported.');\n    }\n  }\n}\n"]}