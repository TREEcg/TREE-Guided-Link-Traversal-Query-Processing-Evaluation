"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ListCredentialsHandler = void 0;
const BasicRepresentation_1 = require("../../../../http/representation/BasicRepresentation");
const ContentTypes_1 = require("../../../../util/ContentTypes");
const CredentialsHandler_1 = require("./CredentialsHandler");
/**
 * Returns a list of all credential tokens associated with this account.
 * Note that this only returns the ID tokens, not the associated secrets.
 */
class ListCredentialsHandler extends CredentialsHandler_1.CredentialsHandler {
    constructor(accountStore) {
        super();
        this.accountStore = accountStore;
    }
    async handle({ operation, body: { webId } }) {
        const credentials = (await this.accountStore.getSettings(webId)).clientCredentials ?? [];
        return new BasicRepresentation_1.BasicRepresentation(JSON.stringify(credentials), operation.target, ContentTypes_1.APPLICATION_JSON);
    }
}
exports.ListCredentialsHandler = ListCredentialsHandler;
//# sourceMappingURL=ListCredentialsHandler.js.map