"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PromptHandler = void 0;
const BadRequestHttpError_1 = require("../../util/errors/BadRequestHttpError");
const FoundHttpError_1 = require("../../util/errors/FoundHttpError");
const InteractionHandler_1 = require("./InteractionHandler");
/**
 * Redirects requests based on the OIDC Interaction prompt.
 * Errors in case no match was found.
 */
class PromptHandler extends InteractionHandler_1.InteractionHandler {
    constructor(promptRoutes) {
        super();
        this.promptRoutes = promptRoutes;
    }
    async handle({ oidcInteraction }) {
        // We also want to redirect on GET so no method check is needed
        const prompt = oidcInteraction?.prompt.name;
        if (prompt && this.promptRoutes[prompt]) {
            const location = this.promptRoutes[prompt].getPath();
            throw new FoundHttpError_1.FoundHttpError(location);
        }
        throw new BadRequestHttpError_1.BadRequestHttpError(`Unsupported prompt: ${prompt}`);
    }
}
exports.PromptHandler = PromptHandler;
//# sourceMappingURL=PromptHandler.js.map